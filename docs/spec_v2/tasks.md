# 实施计划 - 班级积分系统第二版

- [-] 1. 搭建项目基础结构和双存储支持
  - 创建支持多班级的Node.js项目目录结构
  - 配置Express.js服务器和存储适配器架构
  - 实现班级隔离中间件和权限验证中间件
  - 设计存储适配器接口支持MySQL8和SQLite
  - _需求: 1.1, 1.2, 1.3, 1.4, 1.5_

- [ ] 2. 实现数据模型和存储系统
  - [ ] 2.1 创建数据模型和存储适配器
    - 实现数据模型的TypeScript接口定义
    - 编写MySQL8存储适配器（支持多班级）
    - 编写SQLite存储适配器（支持单班级本地部署）
    - _需求: 5.1, 5.2, 5.3, 5.4, 5.5_

  - [ ] 2.2 实现核心数据操作
    - 编写学校和班级信息的CRUD操作
    - 实现用户管理和学号生成逻辑
    - 创建积分记录和商品管理的数据操作
    - 编写存储适配器的单元测试
    - _需求: 1.1, 1.2, 1.3, 1.4, 1.5_

- [ ] 3. 开发核心权限和用户系统
  - [ ] 3.1 实现班级权限管理
    - 创建班主任和任课老师的登录验证
    - 实现基于班级的权限控制系统
    - 编写班级访问权限验证中间件
    - _需求: 3.1, 3.2, 3.3, 3.4, 3.5, 3.6, 3.7, 3.8_

  - [ ] 3.2 实现学生基础管理
    - 创建学生信息的基本CRUD操作
    - 实现班内学号（01-99）生成和验证
    - 编写学生积分余额计算功能
    - _需求: 3.1, 3.2, 3.3, 3.4, 3.5, 3.6, 3.7, 3.8_

- [ ] 4. 开发教室大屏系统（核心功能）
  - [ ] 4.1 实现大屏状态管理和模式切换
    - 创建大屏状态管理器，支持平时模式和上课模式
    - 实现班主任认证和长期登录保持功能
    - 编写任课老师选择和班级密码验证
    - 实现2小时自动切换到平时模式功能
    - _需求: 2.1, 2.2, 2.3, 2.4, 2.5, 2.6, 2.7, 2.8_

  - [ ] 4.2 开发大屏前端界面
    - 创建平时模式的积分排行榜显示界面
    - 实现学生查询入口（底部位置）
    - 编写上课模式的积分操作界面
    - 添加模式切换和教师选择界面
    - _需求: 2.1, 2.2, 2.3, 2.4, 2.5, 2.6, 2.7, 2.8, 8.1, 8.2, 8.3, 8.4_

  - [ ] 4.3 实现大屏积分操作功能
    - 编写学生按学号排序显示功能
    - 实现常用奖惩项的快速操作界面
    - 添加积分加减的实时操作和反馈
    - 创建操作记录和数据同步功能
    - _需求: 9.1, 9.2, 9.3, 9.4, 9.5, 9.6, 4.1, 4.2, 4.3, 4.4, 4.5_

- [ ] 5. 开发班级管理端系统（核心功能）
  - [ ] 5.1 创建班级后台基础框架
    - 实现班主任和任课老师的登录界面
    - 创建基于权限的导航菜单系统
    - 编写班级后台的路由和权限控制
    - _需求: 3.1, 3.2, 3.3, 3.4, 3.5, 3.6, 3.7, 3.8_

  - [ ] 5.2 实现积分管理功能
    - 创建积分操作的API接口和前端界面
    - 实现积分记录查询和历史管理
    - 编写积分余额计算和排名显示
    - 添加班主任专用的积分清零功能（二次确认）
    - _需求: 9.1, 9.2, 9.3, 9.4, 9.5, 9.6, 11.1, 11.2, 11.3, 11.4, 11.5_

  - [ ] 5.3 实现常用奖惩项管理
    - 创建奖惩项的CRUD操作界面
    - 实现奖惩项的排序和状态管理
    - 编写与大屏的数据同步功能
    - _需求: 4.1, 4.2, 4.3, 4.4, 4.5_

- [ ] 6. 实现学生查询和基础商品功能
  - [ ] 6.1 开发学生查询功能
    - 实现学生通过班内学号查询积分功能
    - 创建个人积分历史记录查询
    - 编写查询结果的友好显示界面
    - 实现访问控制和日志记录
    - _需求: 6.1, 6.2, 6.3, 6.4, 6.5, 10.1, 10.2, 10.3, 10.4_

  - [ ] 6.2 实现基础商品和预约功能
    - 创建商品信息的基本CRUD操作
    - 实现简单的商品预约功能
    - 编写预约状态管理和确认流程
    - 添加库存管理和基本验证
    - _需求: 12.1, 12.2, 12.3, 12.4, 13.1, 13.2, 13.3, 13.4, 13.5_

- [ ] 7. 实现实时数据同步
  - [ ] 7.1 集成Server-Sent Events推送机制
    - 在后端实现SSE推送服务
    - 创建数据变更监听和推送逻辑
    - 在前端实现SSE接收和界面更新
    - 添加连接断开重连机制
    - _需求: 8.4, 14.4_

  - [ ] 7.2 实现前端数据自动刷新
    - 编写前端数据缓存和更新逻辑
    - 实现大屏界面的自动刷新功能
    - 添加数据加载状态和错误处理
    - _需求: 8.4, 14.4_

- [ ] 8. 完善系统稳定性
  - [ ] 8.1 实现错误处理和用户反馈
    - 添加全局错误捕获和友好提示
    - 实现表单验证和实时反馈
    - 创建统一的错误处理中间件
    - 添加操作日志记录
    - _需求: 所有需求的错误处理和用户体验_

  - [ ] 8.2 编写核心功能测试
    - 创建教室大屏操作流程测试
    - 实现班级管理端功能测试
    - 编写多班级并发访问测试
    - 添加数据一致性测试
    - _需求: 所有需求的测试验证_

- [ ] 9. 系统部署和上线
  - [ ] 9.1 准备双存储部署方案
    - 创建MySQL8多班级部署配置和初始化脚本
    - 编写SQLite单班级本地部署配置
    - 编写一键启动脚本和部署文档
    - _需求: 系统部署和运维_

  - [ ] 9.2 用户验收和问题修复
    - 测试教室大屏和班级管理端的完整流程
    - 验证多班级隔离和权限控制
    - 测试不同存储方案的兼容性
    - 修复测试中发现的问题并准备用户文档
    - _需求: 所有需求的最终验证_